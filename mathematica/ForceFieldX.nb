(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26543,        525]
NotebookOptionsPosition[     24526,        484]
NotebookOutlinePosition[     24920,        500]
CellTagsIndexPosition[     24877,        497]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Force Field X with Mathematica", "Chapter",
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319720247898*^9, 3.7963198883481913`*^9}, {
   3.7963201658100977`*^9, 3.796320195550817*^9}, {3.7963204706720037`*^9, 
   3.796320509099841*^9}, {3.796320556780018*^9, 3.796320559097172*^9}, 
   3.796320654025756*^9, {3.796322291309527*^9, 3.796322300154826*^9}, {
   3.796557763169304*^9, 3.79655776411285*^9}, {3.796557804727416*^9, 
   3.796557844423911*^9}, {3.796558050793521*^9, 3.7965581908898287`*^9}, 
   3.796558397846035*^9, {3.796563398441401*^9, 3.7965634189391317`*^9}, {
   3.79656385288803*^9, 3.796563904260149*^9}, 3.796564022316124*^9, {
   3.796634933060278*^9, 3.7966349476405773`*^9}, {3.7966349937518177`*^9, 
   3.7966350041399393`*^9}, 3.796635152689011*^9, {3.796635232657337*^9, 
   3.796635234120371*^9}, {3.796635362892253*^9, 3.796635371059825*^9}, {
   3.796635743403186*^9, 3.7966357601884623`*^9}, {3.796635813897436*^9, 
   3.796635819814723*^9}, 3.796639206817993*^9, {3.7967345464585133`*^9, 
   3.796734611487812*^9}, {3.796734660695097*^9, 3.796734664552396*^9}, {
   3.7968295764383173`*^9, 3.796829683835902*^9}, {3.796829713845192*^9, 
   3.796829858258731*^9}, {3.7968326441445312`*^9, 3.796832666488864*^9}, {
   3.796833059662339*^9, 3.796833067228063*^9}, {3.7968336728050003`*^9, 
   3.796833677282938*^9}, {3.796835133747052*^9, 3.796835134865658*^9}, {
   3.796835167023349*^9, 3.796835228003174*^9}, {3.796835285222909*^9, 
   3.796835287492798*^9}, {3.796840341736862*^9, 
   3.796840348621229*^9}},ExpressionUUID->"c66458ef-c2f3-482f-b04d-\
e955dae343bc"],

Cell[TextData[StyleBox["1. Prerequisites: Install Java and Add FFX to the \
Classpath",
 FontColor->GrayLevel[0]]], "Section",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319720247898*^9, 3.7963198883481913`*^9}, {
   3.7963201658100977`*^9, 3.796320195550817*^9}, {3.7963204706720037`*^9, 
   3.796320509099841*^9}, {3.796320556780018*^9, 3.796320559097172*^9}, 
   3.796320654025756*^9, {3.796322291309527*^9, 3.796322300154826*^9}, {
   3.796557763169304*^9, 3.79655776411285*^9}, {3.796557804727416*^9, 
   3.796557844423911*^9}, {3.796558050793521*^9, 3.7965581908898287`*^9}, 
   3.796558397846035*^9, {3.796563398441401*^9, 3.7965634189391317`*^9}, {
   3.79656385288803*^9, 3.796563904260149*^9}, 3.796564022316124*^9, {
   3.796634933060278*^9, 3.7966349476405773`*^9}, {3.7966349937518177`*^9, 
   3.7966350041399393`*^9}, 3.796635152689011*^9, {3.796635232657337*^9, 
   3.796635234120371*^9}, {3.796635362892253*^9, 3.796635371059825*^9}, {
   3.796635743403186*^9, 3.7966357601884623`*^9}, {3.796635813897436*^9, 
   3.796635819814723*^9}, 3.796639206817993*^9, {3.7967345464585133`*^9, 
   3.796734611487812*^9}, {3.796734660695097*^9, 3.796734664552396*^9}, {
   3.7968295764383173`*^9, 3.796829683835902*^9}, {3.796829713845192*^9, 
   3.796829858258731*^9}, {3.7968326441445312`*^9, 3.796832666488864*^9}, {
   3.796833059662339*^9, 3.796833067228063*^9}, {3.7968336728050003`*^9, 
   3.796833677282938*^9}, {3.796835133747052*^9, 3.796835134865658*^9}, {
   3.796835167023349*^9, 3.796835195405162*^9}, {3.796835230769445*^9, 
   3.796835253495193*^9}, {3.79698084043729*^9, 3.796980867438106*^9}, {
   3.79776235118194*^9, 
   3.797762368257784*^9}},ExpressionUUID->"bdfd0022-0a5d-4d92-9854-\
d14957cffb69"],

Cell[TextData[{
 StyleBox["This file is available from (last updated 5/6/2020):\
\[LineSeparator]https://www.wolframcloud.com/obj/michael-schnieders/Published/\
ForceFieldX.nb\n\nForce Field X depends on ", "Text",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["Java version 10 or greater", "Text",
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox[". If your version of Mathematica is using an earlier version, \
please either\[LineSeparator]1) Set the \[OpenCurlyDoubleQuote]JAVA_HOME\
\[CloseCurlyDoubleQuote] environment variable to point to version 10 or \
greater, and then start Mathematica from the command line ", "Text",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["or", "Text",
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox[" \[LineSeparator]2) Edit the javacommand string below from \
\[OpenCurlyDoubleQuote]java \[OpenCurlyDoubleQuote]<>flags to\n javacommand = \
  ", "Text",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["\[OpenCurlyDoubleQuote]/your/path/to/jdk/bin/java \
\[OpenCurlyDoubleQuote]<>flags\n\nThe first time this notebook is executed, \
ffx-all.jar will be downloaded to the Mathematica User Base DIrectory for \
reuse. \nTo update ffx-all.jar, please delete this file and it will be \
re-downloaded.",
  FontSize->14,
  FontColor->GrayLevel[0]]
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319720247898*^9, 3.7963198883481913`*^9}, {
   3.7963201658100977`*^9, 3.796320195550817*^9}, {3.7963204706720037`*^9, 
   3.796320509099841*^9}, {3.796320556780018*^9, 3.796320559097172*^9}, 
   3.796320654025756*^9, {3.796322291309527*^9, 3.796322300154826*^9}, {
   3.796557763169304*^9, 3.79655776411285*^9}, {3.796557804727416*^9, 
   3.796557844423911*^9}, {3.796558050793521*^9, 3.7965581908898287`*^9}, 
   3.796558397846035*^9, {3.796563398441401*^9, 3.7965634189391317`*^9}, {
   3.79656385288803*^9, 3.796563904260149*^9}, 3.796564022316124*^9, {
   3.796634933060278*^9, 3.7966349476405773`*^9}, {3.7966349937518177`*^9, 
   3.7966350041399393`*^9}, 3.796635152689011*^9, {3.796635232657337*^9, 
   3.796635234120371*^9}, {3.796635362892253*^9, 3.796635371059825*^9}, {
   3.796635743403186*^9, 3.7966357601884623`*^9}, {3.796635813897436*^9, 
   3.796635819814723*^9}, 3.796639206817993*^9, {3.7967345464585133`*^9, 
   3.796734611487812*^9}, {3.796734660695097*^9, 3.796734664552396*^9}, {
   3.7968295764383173`*^9, 3.796829683835902*^9}, {3.796829713845192*^9, 
   3.796829858258731*^9}, {3.7968326441445312`*^9, 3.796832666488864*^9}, {
   3.796833059662339*^9, 3.796833067228063*^9}, {3.7968336728050003`*^9, 
   3.796833677282938*^9}, {3.796835133747052*^9, 3.796835134865658*^9}, {
   3.7968351820758123`*^9, 3.7968351983693857`*^9}, {3.796835369868346*^9, 
   3.796835376437099*^9}, {3.796835546701652*^9, 3.796835600521057*^9}, {
   3.7969782893195047`*^9, 3.7969782898497553`*^9}, {3.79697835641722*^9, 
   3.796978356962029*^9}, {3.796980028189582*^9, 3.7969800330084257`*^9}, {
   3.7969801318492002`*^9, 3.796980290162035*^9}, {3.796980523274188*^9, 
   3.796980583300314*^9}, {3.796980621438861*^9, 3.796980678455365*^9}, {
   3.7969807698075457`*^9, 3.7969808289181356`*^9}, {3.796980878462709*^9, 
   3.796981007555127*^9}, {3.796981785843286*^9, 3.796981798353611*^9}, {
   3.797762374558621*^9, 3.797762387475762*^9}, {3.797762821702941*^9, 
   3.79776282181771*^9}},ExpressionUUID->"8fff24bf-fcf8-4846-9d60-\
80d2d041bd8e"],

Cell[BoxData[{
 RowBox[{"Quit", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<JLink`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ffxVersion", " ", "=", " ", "\"\<1.0.0-beta\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "flags", " ", "=", "\"\<-Dj3d.rend=noop -Djava.awt.headless=true\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"javacommand", " ", "=", 
   RowBox[{"\"\<java \>\"", "<>", "flags"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FailureQ", "[", 
    RowBox[{"Environment", "[", "\"\<JAVA_HOME\>\"", "]"}], "]"}], ",", ",", 
   RowBox[{"javacommand", "=", 
    RowBox[{
     RowBox[{"Environment", "[", "\"\<JAVA_HOME\>\"", "]"}], "<>", 
     "\"\</bin/java \>\"", "<>", "flags"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReinstallJava", "[", 
   RowBox[{
    RowBox[{"CommandLine", "\[Rule]", "javacommand"}], ",", " ", 
    RowBox[{"ClassPath", "\[Rule]", "None"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadJavaClass", "[", 
   RowBox[{"\"\<java.lang.Runtime\>\"", ",", " ", 
    RowBox[{"StaticsVisible", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Java version: \>\"", "<>", 
  RowBox[{
   RowBox[{"version", "[", "]"}], "@", 
   RowBox[{"toString", "[", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "$UserBaseDirectory", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ffxFile", " ", "=", " ", 
   RowBox[{"\"\<ffx-all-\>\"", "<>", "ffxVersion", "<>", "\"\<.jar\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "[", "ffxFile", "]"}], ",", 
   RowBox[{"\"\<Using existing Force Field X jar file: \>\"", "<>", " ", 
    RowBox[{"AbsoluteFileName", "[", "ffxFile", "]"}]}], ",", 
   RowBox[{"URLDownload", "[", 
    RowBox[{
    "\"\<https://ffx.biochem.uiowa.edu/ffx-all-1.0.0-beta.jar\>\"", ",", 
     RowBox[{"File", "[", "ffxFile", "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddToClassPath", "[", " ", 
   RowBox[{
    RowBox[{"AbsoluteFileName", "[", "ffxFile", "]"}], ",", " ", 
    RowBox[{"\"\<Prepend\>\"", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Current Directory: \>\"", " ", "<>", 
  RowBox[{"ResetDirectory", "[", "]"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796314172341997*^9, 3.796314173248699*^9}, {
   3.796314545407902*^9, 3.7963145494130087`*^9}, {3.7963145927969103`*^9, 
   3.79631462645579*^9}, {3.79631468583808*^9, 3.796314694341298*^9}, {
   3.79631525177216*^9, 3.796315252467041*^9}, {3.796315604336053*^9, 
   3.796315615089045*^9}, {3.796315762696742*^9, 3.796315772480845*^9}, 
   3.796316090397347*^9, {3.796316378991088*^9, 3.7963164078108177`*^9}, {
   3.796319434041547*^9, 3.7963194368734217`*^9}, {3.7963196850407352`*^9, 
   3.796319702272984*^9}, {3.796319895527026*^9, 3.796319895848812*^9}, {
   3.796557904519747*^9, 3.796558025008265*^9}, {3.796558221600765*^9, 
   3.796558222028757*^9}, {3.796558988607897*^9, 3.7965590216353207`*^9}, {
   3.796559063085082*^9, 3.796559110154477*^9}, {3.796559217976451*^9, 
   3.796559230914063*^9}, {3.7965592837950497`*^9, 3.7965593601154537`*^9}, {
   3.796559398668058*^9, 3.7965594398787537`*^9}, {3.796559481486065*^9, 
   3.796559495522704*^9}, {3.7965595788684483`*^9, 3.796559582376706*^9}, {
   3.796559612509997*^9, 3.796559682013405*^9}, {3.796559723323325*^9, 
   3.7965597282028913`*^9}, {3.796559771678041*^9, 3.796559813323674*^9}, {
   3.796559860574379*^9, 3.7965599711461487`*^9}, 3.79656002060283*^9, {
   3.7965600796967163`*^9, 3.796560087067801*^9}, {3.796560146908255*^9, 
   3.7965601933612003`*^9}, {3.796560223760592*^9, 3.796560228865808*^9}, {
   3.7965603167074137`*^9, 3.7965603617742023`*^9}, {3.7965604145624323`*^9, 
   3.796560490460005*^9}, {3.796560627898026*^9, 3.796560636260198*^9}, {
   3.796560755965912*^9, 3.7965607869953938`*^9}, {3.796560983584619*^9, 
   3.796560996887804*^9}, {3.796561149930429*^9, 3.796561199091805*^9}, {
   3.7965612486653843`*^9, 3.7965612866417933`*^9}, 3.796561321320533*^9, {
   3.796561364520331*^9, 3.796561418563534*^9}, {3.79656165205534*^9, 
   3.796561845288683*^9}, {3.796563339453847*^9, 3.796563363274496*^9}, {
   3.796563423441028*^9, 3.796563424160215*^9}, {3.796638257964097*^9, 
   3.79663826460023*^9}, {3.796638328063662*^9, 3.7966383494509*^9}, {
   3.7966385312590857`*^9, 3.796638562687766*^9}, {3.796638952895308*^9, 
   3.7966389892790327`*^9}, {3.796639043686223*^9, 3.7966391139315147`*^9}, {
   3.7968298608272343`*^9, 3.7968298624666224`*^9}, {3.796833743933317*^9, 
   3.79683374453985*^9}, 3.796835182075972*^9, {3.796978286588044*^9, 
   3.796978309278269*^9}, {3.796978353521957*^9, 3.7969783932290287`*^9}, {
   3.7969784334617367`*^9, 3.7969784426174726`*^9}, {3.7969784927779503`*^9, 
   3.796978563107781*^9}, {3.796978770586092*^9, 3.7969788207843933`*^9}, {
   3.796978853885544*^9, 3.796978881064518*^9}, {3.7969789611011467`*^9, 
   3.796978961576758*^9}, {3.7969790151280518`*^9, 3.796979015684976*^9}, {
   3.796979096674752*^9, 3.7969791025871468`*^9}, {3.796979263890877*^9, 
   3.796979281554274*^9}, {3.796979319062315*^9, 3.7969793412271442`*^9}, {
   3.796979571315137*^9, 3.796979615845694*^9}, {3.7969797961862593`*^9, 
   3.796979858263595*^9}, {3.79697990237043*^9, 3.796980007040873*^9}, {
   3.7969800536602917`*^9, 3.796980114212739*^9}, 3.7969804522154016`*^9, {
   3.796980601804071*^9, 3.796980613519372*^9}, {3.796980726429022*^9, 
   3.796980727102406*^9}, 3.796981054330968*^9, {3.796981125925282*^9, 
   3.7969811892885323`*^9}, {3.796981219372407*^9, 3.7969812986618023`*^9}, {
   3.796981366502334*^9, 3.7969813924222507`*^9}, {3.7969814797257757`*^9, 
   3.796981523916316*^9}, {3.796981629062399*^9, 3.7969816703708677`*^9}, {
   3.7969817172866507`*^9, 3.796981753466632*^9}, 3.7969818234921303`*^9, 
   3.796982989357849*^9, {3.7969830615375013`*^9, 3.796983098663834*^9}, {
   3.797762560256112*^9, 3.797762661168561*^9}, {3.797762738275948*^9, 
   3.7977627644860353`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"77429464-4b40-4ecf-b950-a365590c8cc9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["2. Load a Protein Databank File from the RCSB.", \
"Section",
 FontColor->GrayLevel[0]]], "Section",
 CellChangeTimes->{{3.796635176979826*^9, 3.796635240042182*^9}, 
   3.796635340502087*^9, {3.79663568148125*^9, 3.796635682605012*^9}, {
   3.796635714938384*^9, 3.7966357363148823`*^9}, {3.796635839755865*^9, 
   3.796635843934723*^9}, {3.796635928547269*^9, 3.796635973906665*^9}, {
   3.796636042510766*^9, 3.7966360616135683`*^9}, {3.796636311323917*^9, 
   3.796636319652052*^9}, {3.796636413228283*^9, 3.796636414581088*^9}, 
   3.7968353214889383`*^9},ExpressionUUID->"954ca07f-686c-469b-96cb-\
958ed0147f57"],

Cell["\<\
Download a file from the PDB and render it.
a.) Define a string with a 4-character PDB ID. This example uses the \
SARS-CoV-2 main protease.\[LineSeparator]b.) Import the file from the Protein \
Databank, and save it locally.
c.) Display an 2D image of the structure.\
\>", "Text",
 CellChangeTimes->{{3.796635176979826*^9, 3.796635240042182*^9}, 
   3.796635340502087*^9, {3.79663568148125*^9, 3.796635682605012*^9}, {
   3.796635714938384*^9, 3.7966357363148823`*^9}, {3.796635839755865*^9, 
   3.796635843934723*^9}, {3.796635928547269*^9, 3.796635973906665*^9}, {
   3.796636042510766*^9, 3.7966360616135683`*^9}, {3.796636311323917*^9, 
   3.796636319652052*^9}, {3.796636413228283*^9, 3.796636414581088*^9}, 
   3.796835327882111*^9, {3.796835452805217*^9, 
   3.7968354729893627`*^9}},ExpressionUUID->"303e7e64-6d31-4e49-9274-\
228f7360c8aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pdbID", " ", "=", "\"\<6YB7\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", 
   RowBox[{"pdbID", " ", "<>", "\"\<.pdb\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdb", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"\"\<https://files.rcsb.org/download/\>\"", "<>", "filename"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\"\<PDB\>\"", ",", "\"\<Rules\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"filename", ",", " ", "pdb"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", 
  RowBox[{"filename", ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", " ", "Medium"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7966343921915503`*^9, 3.796634396213505*^9}, {
   3.796634472990549*^9, 3.7966344958322783`*^9}, {3.796634615328989*^9, 
   3.796634693989876*^9}, {3.7966347576011066`*^9, 3.796634871296339*^9}, {
   3.796635402138074*^9, 3.796635446399453*^9}, {3.796635528611723*^9, 
   3.796635546544384*^9}, {3.796635622371907*^9, 3.7966356339591703`*^9}, 
   3.796635665530344*^9, 3.7966359991132298`*^9, {3.796636301833819*^9, 
   3.796636303519103*^9}, {3.796829869601206*^9, 3.796829870204273*^9}, {
   3.796832691579093*^9, 3.79683269227558*^9}, {3.796982863114694*^9, 
   3.796982929683105*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"fb3d587b-f71b-4057-ae81-c2eb49898463"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["3. Use Force Field X Command Line Syntax",
 FontColor->GrayLevel[0]]], "Section",
 CellChangeTimes->{{3.796981910317267*^9, 3.796981970820174*^9}, {
  3.7969832817714233`*^9, 
  3.796983281906084*^9}},ExpressionUUID->"58abe940-dffe-444c-864d-\
995c2d49e525"],

Cell[TextData[StyleBox["Force Field X command line syntax consists of naming \
a script (e.g. \[OpenCurlyDoubleQuote]Energy\[CloseCurlyDoubleQuote] below) \
and passing an array of String arguments (e.g. filename below).\n\nJLink \
documentation: \t\t\
https://reference.wolfram.com/language/JLink/tutorial/Overview.html\
\[LineSeparator]Force Field X documentation: \t\
https://ffx.biochem.uiowa.edu", "Text",
 FontColor->GrayLevel[0]]], "Text",
 CellChangeTimes->{{3.7969820165871677`*^9, 3.796982039582864*^9}, {
  3.796983299502164*^9, 3.796983362956421*^9}, {3.7969834130066566`*^9, 
  3.796983419722739*^9}},ExpressionUUID->"3cdc65cf-963e-4a8b-a400-\
0044977298b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoadJavaClass", "[", 
   RowBox[{"\"\<ffx.Main\>\"", ",", " ", 
    RowBox[{"StaticsVisible", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"script", " ", "=", " ", 
   RowBox[{"ffxScript", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<Energy\>\"", ",", "filename"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"forceFieldEnergy", " ", "=", " ", 
   RowBox[{"script", "@", "forceFieldEnergy"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"forceFieldEnergy", "@", 
  RowBox[{"toString", "[", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7969820531773643`*^9, 3.79698210017661*^9}, {
  3.7969824697040453`*^9, 3.7969824869613256`*^9}, {3.79698256350874*^9, 
  3.7969825638034363`*^9}, {3.7969826155739193`*^9, 3.796982619961277*^9}, {
  3.796983153318821*^9, 3.796983161664558*^9}, {3.796983232362028*^9, 
  3.796983245950436*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"f02619d9-4388-46b2-9452-a1941b1df12c"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["4. Use JLink Syntax to Use the Force Field X ", \
"Section",
 FontColor->GrayLevel[0]]], "Section",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319977969363*^9, 3.796320142181131*^9}, {
  3.796320201467784*^9, 3.7963202888387337`*^9}, {3.796320614226465*^9, 
  3.796320631501848*^9}, {3.7965581956554327`*^9, 3.796558215755371*^9}, {
  3.796558405404787*^9, 3.796558417381403*^9}, {3.796558495121257*^9, 
  3.796558553696693*^9}, {3.7965634370970383`*^9, 3.7965634602055483`*^9}, {
  3.7965635476429253`*^9, 3.7965636722058363`*^9}, {3.796563718873054*^9, 
  3.796563838373661*^9}, {3.796563921379169*^9, 3.796563944217162*^9}, {
  3.796563974662703*^9, 3.796563998041588*^9}, {3.796634147509673*^9, 
  3.796634147963539*^9}, {3.796635244582906*^9, 3.796635306677973*^9}, {
  3.796636091021267*^9, 3.796636233156569*^9}, {3.796639157265048*^9, 
  3.796639159628797*^9}, {3.796835419897318*^9, 3.796835428612894*^9}, {
  3.796983286001318*^9, 
  3.796983286406315*^9}},ExpressionUUID->"fc72bfd0-3b60-41bd-a6e2-\
ff7f66a13355"],

Cell[TextData[StyleBox["Alternatively, more precise control is possible using \
JLink Syntax to use the entire Force Field X API.\n \[LineSeparator]a.) An \
ArrayList (list) is created and loaded with String \
arguments.\[LineSeparator]b.) A Groovy Binding is created, and the \"args\" \
property is set to the list.\[LineSeparator]c.) The Energy script is created, \
loaded with the Groovy Binding, and its run method called.\[LineSeparator]d.) \
Finally, the toString method of the Energy script field  \"forceFieldEnergy\" \
is called.", "Text",
 FontColor->GrayLevel[0]]], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796319977969363*^9, 3.796320142181131*^9}, {
   3.796320201467784*^9, 3.7963202888387337`*^9}, {3.796320614226465*^9, 
   3.796320631501848*^9}, {3.7965581956554327`*^9, 3.796558215755371*^9}, {
   3.796558405404787*^9, 3.796558417381403*^9}, {3.796558495121257*^9, 
   3.796558553696693*^9}, {3.7965634370970383`*^9, 3.7965634602055483`*^9}, {
   3.7965635476429253`*^9, 3.7965636722058363`*^9}, {3.796563718873054*^9, 
   3.796563838373661*^9}, {3.796563921379169*^9, 3.796563944217162*^9}, {
   3.796563974662703*^9, 3.796563998041588*^9}, {3.796634147509673*^9, 
   3.796634147963539*^9}, {3.796635244582906*^9, 3.796635306677973*^9}, {
   3.796636091021267*^9, 3.796636233156569*^9}, {3.796639157265048*^9, 
   3.796639159628797*^9}, {3.7968354286130323`*^9, 3.7968354312275743`*^9}, 
   3.7969832969050283`*^9, {3.7969833865569353`*^9, 3.796983386986826*^9}, {
   3.796983428025218*^9, 
   3.796983494132329*^9}},ExpressionUUID->"eb6470cf-34e3-45cb-8009-\
04d4ccc9158c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"list", " ", "=", " ", 
   RowBox[{"JavaNew", "[", "\"\<java.util.ArrayList\>\"", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", "@", 
   RowBox[{"add", "[", 
    RowBox[{"JavaNew", "[", 
     RowBox[{"\"\<java.lang.String\>\"", ",", "filename"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binding", " ", "=", " ", 
   RowBox[{"JavaNew", "[", "\"\<groovy.lang.Binding\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binding", "@", 
   RowBox[{"setProperty", "[", 
    RowBox[{"\"\<args\>\"", ",", "list"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"script", " ", "=", " ", 
   RowBox[{"JavaNew", "[", "\"\<ffx.potential.groovy.Energy\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"script", "@", 
   RowBox[{"setBinding", "[", "binding", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"script", "@", 
   RowBox[{"run", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"forceFieldEnergy", " ", "=", " ", 
   RowBox[{"script", "@", "forceFieldEnergy"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"forceFieldEnergy", "@", 
  RowBox[{"toString", "[", "]"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.796314995873674*^9, 3.79631500901157*^9}, {
   3.7963151094787617`*^9, 3.796315165143322*^9}, {3.796315238743762*^9, 
   3.796315240563737*^9}, {3.796315397104479*^9, 3.796315504318283*^9}, {
   3.796315588390046*^9, 3.796315593240342*^9}, {3.796315655342431*^9, 
   3.796315656018621*^9}, {3.796316448904894*^9, 3.79631645177849*^9}, {
   3.796318966836712*^9, 3.796318967801186*^9}, {3.796319240494895*^9, 
   3.7963192433902807`*^9}, {3.796319303538065*^9, 3.79631930403563*^9}, {
   3.796319960062272*^9, 3.7963199614550743`*^9}, {3.796320310967033*^9, 
   3.796320311744657*^9}, 3.796320410252369*^9, {3.796322229390833*^9, 
   3.796322246964287*^9}, {3.796558580893156*^9, 3.796558616038336*^9}, {
   3.796558665295681*^9, 3.79655866742901*^9}, {3.7965587487927103`*^9, 
   3.7965589178166523`*^9}, {3.796561887324175*^9, 3.7965619392968903`*^9}, 
   3.796562010403489*^9, {3.7965621748566523`*^9, 3.796562286507094*^9}, {
   3.796562356053624*^9, 3.7965623673048897`*^9}, {3.79656247439052*^9, 
   3.796562493557588*^9}, {3.796562565738244*^9, 3.796562704567507*^9}, {
   3.796562740410612*^9, 3.796562910446607*^9}, {3.7965631010305653`*^9, 
   3.796563130008253*^9}, {3.7965631681590548`*^9, 3.796563310152258*^9}, {
   3.79656346848903*^9, 3.796563524114964*^9}, {3.796563685844124*^9, 
   3.796563710170115*^9}, {3.79663415419769*^9, 3.7966341645438843`*^9}, {
   3.79663489152673*^9, 3.796634892941928*^9}, 3.7968354286131487`*^9},
 CellLabel->
  "In[111]:=",ExpressionUUID->"15999c6d-86d5-4530-83f7-40813158a58c"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 1395},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6360de4a-4dbf-42a9-8d95-91a31bc53b84"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1718, 25, 84, "Title",ExpressionUUID->"c66458ef-c2f3-482f-b04d-e955dae343bc",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2301, 49, 1762, 26, 67, "Section",ExpressionUUID->"bdfd0022-0a5d-4d92-9854-d14957cffb69",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[4066, 77, 3505, 62, 222, "Text",ExpressionUUID->"8fff24bf-fcf8-4846-9d60-80d2d041bd8e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[7574, 141, 6304, 116, 325, "Input",ExpressionUUID->"77429464-4b40-4ecf-b950-a365590c8cc9",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[13915, 262, 642, 10, 67, "Section",ExpressionUUID->"954ca07f-686c-469b-96cb-958ed0147f57"],
Cell[14560, 274, 859, 15, 104, "Text",ExpressionUUID->"303e7e64-6d31-4e49-9274-228f7360c8aa"],
Cell[15422, 291, 1471, 32, 115, "Input",ExpressionUUID->"fb3d587b-f71b-4057-ae81-c2eb49898463"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16930, 328, 282, 5, 67, "Section",ExpressionUUID->"58abe940-dffe-444c-864d-995c2d49e525"],
Cell[17215, 335, 671, 11, 104, "Text",ExpressionUUID->"3cdc65cf-963e-4a8b-a400-0044977298b2"],
Cell[17889, 348, 1008, 24, 94, "Input",ExpressionUUID->"f02619d9-4388-46b2-9452-a1941b1df12c"],
Cell[CellGroupData[{
Cell[18922, 376, 1085, 17, 67, "Section",ExpressionUUID->"fc72bfd0-3b60-41bd-a6e2-ff7f66a13355",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[20010, 395, 1638, 24, 150, "Text",ExpressionUUID->"eb6470cf-34e3-45cb-8009-04d4ccc9158c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[21651, 421, 2847, 59, 199, "Input",ExpressionUUID->"15999c6d-86d5-4530-83f7-40813158a58c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]]
}, Open  ]]
}
]
*)

